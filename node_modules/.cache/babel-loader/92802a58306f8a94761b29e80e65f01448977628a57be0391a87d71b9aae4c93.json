{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\abdel\\\\Downloads\\\\qr_attendance_pwa_with_camera\\\\src\\\\QRScannerCameraApp.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useRef, useState } from \"react\";\nimport { Html5Qrcode } from \"html5-qrcode\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst GOOGLE_SCRIPT_URL = \"https://script.google.com/macros/s/AKfycbxLjjl1OC7etF5yZK_IMj0_U3q_HHQ54kBNKMvSfDN72HvYzMVzB3s7TwydWKtyUHz_Jg/exec\";\nexport default function QRScannerCameraApp() {\n  _s();\n  const [status, setStatus] = useState(\"\");\n  const [log, setLog] = useState([]);\n  const [feedbackIcon, setFeedbackIcon] = useState(null);\n  const qrCodeRegionId = \"reader\";\n  const html5QrCodeRef = useRef(null);\n  const isProcessingRef = useRef(false);\n  const handleScanSuccess = async decodedText => {\n    if (isProcessingRef.current) return;\n    isProcessingRef.current = true;\n    try {\n      const response = await fetch(GOOGLE_SCRIPT_URL, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify({\n          scannedId: decodedText\n        })\n      });\n      const result = await response.json();\n      const feedback = result.status === \"success\" ? {\n        icon: \"✅\",\n        message: \"Submitted\"\n      } : result.message === \"Already scanned\" ? {\n        icon: \"⚠️\",\n        message: \"Already Scanned\"\n      } : {\n        icon: \"❌\",\n        message: result.message || \"Invalid QR\"\n      };\n      setFeedbackIcon(feedback.icon);\n      setStatus(feedback.message);\n      const newLog = {\n        id: decodedText,\n        result: feedback.message,\n        time: new Date().toLocaleTimeString()\n      };\n      setLog(prev => [...prev, newLog]);\n\n      // Pause scanner for 3 seconds\n      await html5QrCodeRef.current.stop();\n      await html5QrCodeRef.current.clear();\n      setTimeout(() => {\n        setFeedbackIcon(null);\n        setStatus(\"\");\n        isProcessingRef.current = false;\n        Html5Qrcode.getCameras().then(devices => {\n          if (devices && devices.length) {\n            html5QrCodeRef.current.start({\n              facingMode: \"environment\"\n            }, {\n              fps: 10,\n              qrbox: 250\n            }, handleScanSuccess);\n          }\n        });\n      }, 3000);\n    } catch (error) {\n      console.error(\"Error during scan:\", error);\n      setFeedbackIcon(\"❌\");\n      setStatus(\"Error\");\n      isProcessingRef.current = false;\n    }\n  };\n  useEffect(() => {\n    html5QrCodeRef.current = new Html5Qrcode(qrCodeRegionId);\n    Html5Qrcode.getCameras().then(devices => {\n      if (devices && devices.length) {\n        html5QrCodeRef.current.start({\n          facingMode: \"environment\"\n        }, {\n          fps: 10,\n          qrbox: 250\n        }, handleScanSuccess);\n      }\n    });\n    return () => {\n      var _html5QrCodeRef$curre;\n      (_html5QrCodeRef$curre = html5QrCodeRef.current) === null || _html5QrCodeRef$curre === void 0 ? void 0 : _html5QrCodeRef$curre.stop().then(() => {\n        html5QrCodeRef.current.clear();\n      });\n    };\n  }, []);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      textAlign: \"center\"\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"Scan QR Code\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      id: qrCodeRegionId,\n      style: {\n        width: \"100%\",\n        maxWidth: 400,\n        margin: \"auto\"\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 7\n    }, this), feedbackIcon && /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        marginTop: 20,\n        fontSize: \"4rem\",\n        animation: \"pop 0.4s ease-out\"\n      },\n      children: feedbackIcon\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      children: [\"Status: \", status]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n      children: log.map((entry, i) => /*#__PURE__*/_jsxDEV(\"li\", {\n        children: [entry.time, \" - \", entry.id, \" - \", entry.result]\n      }, i, true, {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 11\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"style\", {\n      children: `\n          @keyframes pop {\n            0% { transform: scale(0.5); opacity: 0; }\n            100% { transform: scale(1); opacity: 1; }\n          }\n        `\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 91,\n    columnNumber: 5\n  }, this);\n}\n_s(QRScannerCameraApp, \"bdSxGQJG7X0tdvpEDqGc6z6oQXo=\");\n_c = QRScannerCameraApp;\nvar _c;\n$RefreshReg$(_c, \"QRScannerCameraApp\");","map":{"version":3,"names":["React","useEffect","useRef","useState","Html5Qrcode","jsxDEV","_jsxDEV","GOOGLE_SCRIPT_URL","QRScannerCameraApp","_s","status","setStatus","log","setLog","feedbackIcon","setFeedbackIcon","qrCodeRegionId","html5QrCodeRef","isProcessingRef","handleScanSuccess","decodedText","current","response","fetch","method","headers","body","JSON","stringify","scannedId","result","json","feedback","icon","message","newLog","id","time","Date","toLocaleTimeString","prev","stop","clear","setTimeout","getCameras","then","devices","length","start","facingMode","fps","qrbox","error","console","_html5QrCodeRef$curre","style","textAlign","children","fileName","_jsxFileName","lineNumber","columnNumber","width","maxWidth","margin","marginTop","fontSize","animation","map","entry","i","_c","$RefreshReg$"],"sources":["C:/Users/abdel/Downloads/qr_attendance_pwa_with_camera/src/QRScannerCameraApp.js"],"sourcesContent":["import React, { useEffect, useRef, useState } from \"react\";\nimport { Html5Qrcode } from \"html5-qrcode\";\n\nconst GOOGLE_SCRIPT_URL =\n  \"https://script.google.com/macros/s/AKfycbxLjjl1OC7etF5yZK_IMj0_U3q_HHQ54kBNKMvSfDN72HvYzMVzB3s7TwydWKtyUHz_Jg/exec\";\n\nexport default function QRScannerCameraApp() {\n  const [status, setStatus] = useState(\"\");\n  const [log, setLog] = useState([]);\n  const [feedbackIcon, setFeedbackIcon] = useState(null);\n  const qrCodeRegionId = \"reader\";\n  const html5QrCodeRef = useRef(null);\n  const isProcessingRef = useRef(false);\n\n  const handleScanSuccess = async (decodedText) => {\n    if (isProcessingRef.current) return;\n    isProcessingRef.current = true;\n\n    try {\n      const response = await fetch(GOOGLE_SCRIPT_URL, {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ scannedId: decodedText }),\n      });\n\n      const result = await response.json();\n\n      const feedback =\n        result.status === \"success\"\n          ? { icon: \"✅\", message: \"Submitted\" }\n          : result.message === \"Already scanned\"\n          ? { icon: \"⚠️\", message: \"Already Scanned\" }\n          : { icon: \"❌\", message: result.message || \"Invalid QR\" };\n\n      setFeedbackIcon(feedback.icon);\n      setStatus(feedback.message);\n\n      const newLog = {\n        id: decodedText,\n        result: feedback.message,\n        time: new Date().toLocaleTimeString(),\n      };\n      setLog((prev) => [...prev, newLog]);\n\n      // Pause scanner for 3 seconds\n      await html5QrCodeRef.current.stop();\n      await html5QrCodeRef.current.clear();\n\n      setTimeout(() => {\n        setFeedbackIcon(null);\n        setStatus(\"\");\n        isProcessingRef.current = false;\n        Html5Qrcode.getCameras().then((devices) => {\n          if (devices && devices.length) {\n            html5QrCodeRef.current.start(\n              { facingMode: \"environment\" },\n              { fps: 10, qrbox: 250 },\n              handleScanSuccess\n            );\n          }\n        });\n      }, 3000);\n    } catch (error) {\n      console.error(\"Error during scan:\", error);\n      setFeedbackIcon(\"❌\");\n      setStatus(\"Error\");\n      isProcessingRef.current = false;\n    }\n  };\n\n  useEffect(() => {\n    html5QrCodeRef.current = new Html5Qrcode(qrCodeRegionId);\n    Html5Qrcode.getCameras().then((devices) => {\n      if (devices && devices.length) {\n        html5QrCodeRef.current.start(\n          { facingMode: \"environment\" },\n          { fps: 10, qrbox: 250 },\n          handleScanSuccess\n        );\n      }\n    });\n\n    return () => {\n      html5QrCodeRef.current?.stop().then(() => {\n        html5QrCodeRef.current.clear();\n      });\n    };\n  }, []);\n\n  return (\n    <div style={{ textAlign: \"center\" }}>\n      <h2>Scan QR Code</h2>\n      <div id={qrCodeRegionId} style={{ width: \"100%\", maxWidth: 400, margin: \"auto\" }}></div>\n\n      {feedbackIcon && (\n        <div\n          style={{\n            marginTop: 20,\n            fontSize: \"4rem\",\n            animation: \"pop 0.4s ease-out\",\n          }}\n        >\n          {feedbackIcon}\n        </div>\n      )}\n\n      <p>Status: {status}</p>\n      <ul>\n        {log.map((entry, i) => (\n          <li key={i}>\n            {entry.time} - {entry.id} - {entry.result}\n          </li>\n        ))}\n      </ul>\n\n      <style>\n        {`\n          @keyframes pop {\n            0% { transform: scale(0.5); opacity: 0; }\n            100% { transform: scale(1); opacity: 1; }\n          }\n        `}\n      </style>\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}